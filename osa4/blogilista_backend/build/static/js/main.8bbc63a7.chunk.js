(this.webpackJsonpblogilista_frontend=this.webpackJsonpblogilista_frontend||[]).push([[0],{41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(16),o=n.n(a),u=n(3),c=n.n(u),l=n(5),i=n(4),s=n(0),j=function(e){return Object(s.jsxs)("div",{children:["Search ",Object(s.jsx)("input",{onChange:e.onChange})]})},f=function(e){return Object(s.jsxs)("form",{onSubmit:e.onSubmit,children:[Object(s.jsxs)("div",{children:["Title: ",Object(s.jsx)("input",{value:e.titleValue,onChange:e.onTitleChange})]}),Object(s.jsxs)("div",{children:["Author: ",Object(s.jsx)("input",{value:e.authorValue,onChange:e.onAuthorChange})]}),Object(s.jsxs)("div",{children:["Url: ",Object(s.jsx)("input",{value:e.urlValue,onChange:e.onUrlChange})]}),Object(s.jsx)("div",{children:Object(s.jsx)("button",{type:"submit",children:"add"})})]})},d=function(e){var t=e.blog,n=e.toggleDelete,r=e.toggleLike;return Object(s.jsxs)("li",{className:"blog",children:[t.title," by ",t.author," with ",t.likes," likes",Object(s.jsx)("button",{onClick:r,children:"like"}),Object(s.jsx)("button",{onClick:n,children:"delete"})]},t.title)},b=n(6),h=n.n(b),g="api/blogs",p=null,O={getAll:function(){return h.a.get(g).then((function(e){return e.data}))},create:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:p}},e.next=3,h.a.post(g,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(e){return console.log("tassa",e),h.a.delete(g+"/".concat(e)).then((function(e){return e.data}))},put:function(e,t){return h.a.put(g+"/".concat(e),t).then((function(e){return e.data}))},setToken:function(e){p="bearer ".concat(e)}},v=function(e){var t=e.message,n=e.className;return null===t?null:Object(s.jsx)("div",{className:n,children:t})},m={login:function(){var e=Object(l.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x=function(e){return Object(s.jsxs)("form",{onSubmit:e.onSubmit,children:[Object(s.jsxs)("div",{children:["username",Object(s.jsx)("input",{type:"text",value:e.usernameValue,name:"Username",onChange:e.onUsernameChange})]}),Object(s.jsxs)("div",{children:["password",Object(s.jsx)("input",{type:"password",value:e.passwordValue,name:"Password",onChange:e.onPasswordChange})]}),Object(s.jsx)("button",{type:"submit",children:"login"})]})},w=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(null),u=Object(i.a)(o,2),b=u[0],h=u[1],g=Object(r.useState)(""),p=Object(i.a)(g,2),w=p[0],C=p[1],k=Object(r.useState)(""),S=Object(i.a)(k,2),y=S[0],T=S[1],D=Object(r.useState)(""),A=Object(i.a)(D,2),V=A[0],L=A[1],B=Object(r.useState)(""),U=Object(i.a)(B,2),N=U[0],I=U[1],J=n.filter((function(e){return e.title.toLowerCase().includes(N.toLowerCase())})),E=Object(r.useState)(null),P=Object(i.a)(E,2),_=P[0],z=P[1],Y=Object(r.useState)(""),q=Object(i.a)(Y,2),F=q[0],G=q[1],H=Object(r.useState)(""),K=Object(i.a)(H,2),M=K[0],Q=K[1],R=Object(r.useState)(null),W=Object(i.a)(R,2),X=W[0],Z=W[1],$=Object(r.useCallback)((function(){O.getAll().then((function(e){a(e)}))}),[]);Object(r.useEffect)((function(){O.getAll().then((function(e){a(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);Z(t),O.setToken(t.token)}}),[]);var ee=function(e){e.preventDefault();var t={title:w,author:y,url:V};console.log(t);var r=n.filter((function(e){return e.title.toLowerCase()===w.toLowerCase()}));r[0]?(z("error"),h("A blog by the name ".concat(r[0].title," is already on Blogister.")),setTimeout((function(){z(null),h(null)}),2e3),C(""),T(""),L(""),I("")):O.create(t).then((function(e){a(n.concat(e)),C(""),T(""),L(""),I(""),z("update"),h("".concat(t.title," was added to the Blogister-list")),setTimeout((function(){z(null),h(null)}),2e3)})).catch((function(e){z("error"),h("".concat(e.response.data.error)),setTimeout((function(){z(null),h(null)}),3e3)}))},te=function(e){e.preventDefault(),C(e.target.value)},ne=function(e){e.preventDefault(),T(e.target.value)},re=function(e){e.preventDefault(),L(e.target.value)},ae=function(e){e.preventDefault(),I(e.target.value.toLowerCase())},oe=function(){var e=Object(l.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,m.login({username:F,password:M});case 4:n=e.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(n)),O.setToken(n.token),Z(n),G(""),Q(""),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),z("delete"),h("wrong credentials"),setTimeout((function(){z(null),h(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(l.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("logging out with the username",F),localStorage.clear(),z("update"),h("Logged out"),setTimeout((function(){z(null),h(null)}),5e3);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(e){e.preventDefault(),G(e.target.value)},le=function(e){e.preventDefault(),Q(e.target.value)};return Object(s.jsxs)("div",{children:[Object(s.jsx)("h1",{children:"Blogister v. 0.0.3.6.2"}),null===X?Object(s.jsx)(x,{onSubmit:oe,usernameValue:F,onUsernameChange:ce,passwordValue:M,onPasswordChange:le}):Object(s.jsxs)("div",{children:[Object(s.jsxs)("p",{children:["Logged in as: ",X.name," ",Object(s.jsx)("button",{onClick:ue,children:"logout"})]}),Object(s.jsxs)("div",{children:[Object(s.jsx)(j,{onChange:ae}),Object(s.jsx)("h2",{children:"Add a new blog to the list"}),Object(s.jsx)(f,{onSubmit:ee,titleValue:w,onTitleChange:te,authorValue:y,onAuthorChange:ne,urlValue:V,onUrlChange:re}),Object(s.jsx)("h2",{children:"Blogs"}),Object(s.jsx)("ul",{children:J.map((function(e){return Object(s.jsx)(d,{blog:e,toggleLike:function(){return function(e){var t=n.filter((function(t){return t.id===e}))[0],r={title:t.title,author:t.author,url:t.url,likes:t.likes+1};O.put(e,r).then((function(){$(),z("update"),h("You liked ".concat(r.title,"!")),setTimeout((function(){z(null),h(null)}),3e3)})).catch((function(e){console.log(e)}))}(e.id)},toggleDelete:function(){return function(e){console.log("blog no "+e+" needs to be deleted");var t=J.find((function(t){return t.id===e}));window.confirm("Delete ".concat(t.title," ?"))&&O.remove(e).then((function(){$(),z("delete"),h("".concat(t.title," was removed from the Blogister-list")),setTimeout((function(){z(null),h(null)}),2e3)})).catch((function(e){$(),z("delete"),h("Information of ".concat(t.title," has already been removed from the server.")),setTimeout((function(){z(null),h(null)}),2e3)}))}(e.id)}},e.id)}))})]})]}),Object(s.jsx)(v,{message:b,className:_})]})};n(41);o.a.render(Object(s.jsx)(w,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.8bbc63a7.chunk.js.map