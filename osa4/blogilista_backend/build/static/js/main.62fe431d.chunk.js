(this.webpackJsonpblogilista_frontend=this.webpackJsonpblogilista_frontend||[]).push([[0],{41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(16),c=n.n(a),o=n(3),u=n.n(o),l=n(5),i=n(4),s=n(0),j=function(e){return Object(s.jsxs)("div",{children:["Search ",Object(s.jsx)("input",{onChange:e.onChange})]})},b=function(e){var t=e.onSubmit,n=e.titleValue,r=e.onTitleChange,a=e.authorValue,c=e.onAuthorChange,o=e.urlValue,u=e.onUrlChange;return Object(s.jsxs)("form",{onSubmit:t,children:[Object(s.jsxs)("div",{children:["Title: ",Object(s.jsx)("input",{value:n,onChange:r})]}),Object(s.jsxs)("div",{children:["Author: ",Object(s.jsx)("input",{value:a,onChange:c})]}),Object(s.jsxs)("div",{children:["Url: ",Object(s.jsx)("input",{value:o,onChange:u})]}),Object(s.jsx)("div",{children:Object(s.jsx)("button",{type:"submit",children:"add"})})]})},d=function(e){var t=e.blog,n=e.toggleDelete,r=e.toggleLike;return Object(s.jsxs)("li",{className:"blog",children:[t.title," by ",t.author," with ",t.likes," likes",Object(s.jsx)("button",{onClick:r,children:"like"}),Object(s.jsx)("button",{onClick:n,children:"delete"})]},t.title)},h=function(e){var t=e.message,n=e.className;return null===t?null:Object(s.jsx)("div",{className:n,children:t})},f=function(e){var t=e.handleSubmit,n=e.onPasswordChange,r=e.onUsernameChange,a=e.username,c=e.password;return Object(s.jsxs)("div",{children:[Object(s.jsx)("h2",{children:"Login"}),Object(s.jsxs)("form",{onSubmit:t,children:[Object(s.jsxs)("div",{children:["username",Object(s.jsx)("input",{value:a,onChange:r})]}),Object(s.jsxs)("div",{children:["password",Object(s.jsx)("input",{type:"password",value:c,onChange:n})]}),Object(s.jsx)("button",{type:"submit",children:"login"})]})]})},g=function(e){var t=Object(r.useState)(!1),n=Object(i.a)(t,2),a=n[0],c=n[1],o={display:a?"none":""},u={display:a?"":"none"},l=function(){c(!a)};return Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{style:o,children:Object(s.jsx)("button",{onClick:l,children:e.buttonLabel})}),Object(s.jsxs)("div",{style:u,children:[e.children,Object(s.jsx)("button",{onClick:l,children:"cancel"})]})]})},p=n(6),O=n.n(p),v={login:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x="api/blogs",m=null,w={getAll:function(){return O.a.get(x).then((function(e){return e.data}))},create:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:m}},e.next=3,O.a.post(x,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("tassa",t),n={headers:{Authorization:m}},e.next=4,O.a.delete(x+"/".concat(t),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),put:function(e,t){return O.a.put(x+"/".concat(e),t).then((function(e){return e.data}))},setToken:function(e){m="bearer ".concat(e)}},C=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),o=Object(i.a)(c,2),p=o[0],O=o[1],x=Object(r.useState)(""),m=Object(i.a)(x,2),C=m[0],k=m[1],S=Object(r.useState)(""),y=Object(i.a)(S,2),T=y[0],L=y[1],A=Object(r.useState)(""),D=Object(i.a)(A,2),B=D[0],U=D[1],N=Object(r.useState)(""),V=Object(i.a)(N,2),E=V[0],J=V[1],I=n.filter((function(e){return e.title.toLowerCase().includes(E.toLowerCase())})),z=Object(r.useState)(null),P=Object(i.a)(z,2),_=P[0],Y=P[1],q=Object(r.useState)(""),F=Object(i.a)(q,2),G=F[0],H=F[1],K=Object(r.useState)(""),M=Object(i.a)(K,2),Q=M[0],R=M[1],W=Object(r.useState)(null),X=Object(i.a)(W,2),Z=X[0],$=X[1],ee=Object(r.useCallback)((function(){w.getAll().then((function(e){a(e)}))}),[]);Object(r.useEffect)((function(){w.getAll().then((function(e){a(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);$(t),w.setToken(t.token)}}),[]);var te=function(e){e.preventDefault();var t={title:C,author:T,url:B};console.log(t);var r=n.filter((function(e){return e.title.toLowerCase()===C.toLowerCase()}));r[0]?(Y("error"),O("A blog by the name ".concat(r[0].title," is already on Blogister.")),setTimeout((function(){Y(null),O(null)}),2e3),k(""),L(""),U(""),J("")):w.create(t).then((function(e){a(n.concat(e)),k(""),L(""),U(""),J(""),Y("update"),O("".concat(t.title," was added to the Blogister-list")),setTimeout((function(){Y(null),O(null)}),2e3)})).catch((function(e){Y("error"),O("".concat(e.response.data.error)),setTimeout((function(){Y(null),O(null)}),3e3)}))},ne=function(e){e.preventDefault(),k(e.target.value)},re=function(e){e.preventDefault(),L(e.target.value)},ae=function(e){e.preventDefault(),U(e.target.value)},ce=function(e){e.preventDefault(),J(e.target.value.toLowerCase())},oe=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,v.login({username:G,password:Q});case 4:n=e.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(n)),w.setToken(n.token),$(n),H(""),R(""),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),Y("delete"),O("wrong username or password"),setTimeout((function(){Y(null),O(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("logging out with the username",G),localStorage.clear(),Y("update"),O("Logged out"),setTimeout((function(){Y(null),O(null)}),5e3);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{children:[Object(s.jsx)("h1",{children:"Blogister v. 0.0.3.7.2"}),null===Z?Object(s.jsx)(g,{buttonLabel:"log in",children:Object(s.jsx)(f,{username:G,password:Q,onUsernameChange:function(e){var t=e.target;return H(t.value)},onPasswordChange:function(e){var t=e.target;return R(t.value)},handleSubmit:oe})}):Object(s.jsxs)("div",{children:[Object(s.jsxs)("p",{children:["Logged in as: ",Z.name," ",Object(s.jsx)("button",{onClick:ue,children:"logout"})]}),Object(s.jsxs)("div",{children:[Object(s.jsx)(j,{onChange:ce}),Object(s.jsx)("h2",{children:"Add a new blog to the list"}),Object(s.jsx)(g,{buttonLabel:"new blog",children:Object(s.jsx)(b,{onSubmit:te,titleValue:C,onTitleChange:ne,authorValue:T,onAuthorChange:re,urlValue:B,onUrlChange:ae})}),Object(s.jsx)("h2",{children:"Blogs"}),Object(s.jsx)("ul",{children:I.map((function(e){return Object(s.jsx)(d,{blog:e,toggleLike:function(){return function(e){var t=n.filter((function(t){return t.id===e}))[0],r={title:t.title,author:t.author,url:t.url,likes:t.likes+1};w.put(e,r).then((function(){ee(),Y("update"),O("You liked ".concat(r.title,"!")),setTimeout((function(){Y(null),O(null)}),3e3)})).catch((function(e){console.log(e)}))}(e.id)},toggleDelete:function(){return function(e){console.log("blog no "+e+" needs to be deleted");var t=I.find((function(t){return t.id===e}));window.confirm("Delete ".concat(t.title," ?"))&&w.remove(e).then((function(){ee(),Y("delete"),O("".concat(t.title," was removed from the Blogister-list")),setTimeout((function(){Y(null),O(null)}),2e3)})).catch((function(e){ee(),Y("delete"),O("Error has occurred. Could not delete ".concat(t.title,".")),setTimeout((function(){Y(null),O(null)}),2e3)}))}(e.id)}},e.id)}))})]})]}),Object(s.jsx)(h,{message:p,className:_})]})};n(41);c.a.render(Object(s.jsx)(C,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.62fe431d.chunk.js.map