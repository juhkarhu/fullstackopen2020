(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(17),c=n.n(a),s=n(1),o=n.n(s),u=n(5),i=n(3),l=n(8),d=n(0),j=function(e){var t=e.blog,n=Object(r.useState)(t),a=Object(i.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(!1),u=Object(i.a)(o,2),j=u[0],b=u[1],p={display:j?"":"none"},f=j?"hide":"view";return Object(d.jsxs)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},classname:"blog",children:[Object(d.jsx)("div",{children:Object(d.jsxs)("p",{children:[t.title," ",Object(d.jsx)("button",{onClick:function(){b(!j)},children:f})]})}),Object(d.jsxs)("div",{style:p,children:[Object(d.jsx)("p",{children:t.url}),Object(d.jsxs)("p",{children:["Likes: ",c.likes," ",Object(d.jsx)("button",{onClick:function(){var n=Object(l.a)(Object(l.a)({},t),{},{likes:t.likes+1});e.updateBlog(n),s(n)},children:"Like"})]}),t.author,Object(d.jsx)("button",{onClick:function(){return e.removeBlog(t)},children:"Delete"})]})]})},b=n(6),p=n.n(b),f="/api/blogs",h=null,v=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get(f);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,p.a.post(f,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,p.a.delete(f+"/".concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x={getAll:v,setToken:function(e){h="bearer ".concat(e)},create:O,put:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:h}},e.next=3,p.a.put(f+"/".concat(t),n,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:g},m={login:function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w=function(e){var t=e.message,n=e.className;return null===t?null:Object(d.jsx)("div",{className:n,children:t})},k=function(e){var t=Object(r.useState)(!1),n=Object(i.a)(t,2),a=n[0],c=n[1],s={display:a?"none":""},o={display:a?"":"none"},u=function(){c(!a)};return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{style:s,children:Object(d.jsx)("button",{onClick:u,children:e.buttonLabel})}),Object(d.jsxs)("div",{style:o,children:[e.children,Object(d.jsx)("button",{onClick:u,children:"Cancel"})]})]})},y=function(e){var t=e.username,n=e.password,r=e.onUsernameChange,a=e.onPasswordChange,c=e.handleSubmit;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Login"}),Object(d.jsxs)("form",{onSubmit:c,children:[Object(d.jsxs)("div",{children:["username",Object(d.jsx)("input",{value:t,onChange:r})]}),Object(d.jsxs)("div",{children:["password",Object(d.jsx)("input",{type:"password",value:n,onChange:a})]}),Object(d.jsx)("button",{type:"submit",children:"login"})]})]})},S=function(e){var t=e.createBlog,n=Object(r.useState)(""),a=Object(i.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(""),u=Object(i.a)(o,2),l=u[0],j=u[1],b=Object(r.useState)(""),p=Object(i.a)(b,2),f=p[0],h=p[1];return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Add a new blog to the list"}),Object(d.jsxs)("form",{onSubmit:function(e){console.log("1"),e.preventDefault(),console.log("2"),t({title:c,author:l,url:f}),console.log("3"),s(""),j(""),h("")},children:[Object(d.jsxs)("div",{children:["Title: ",Object(d.jsx)("input",{value:c,onChange:function(e){e.preventDefault(),s(e.target.value)}})]}),Object(d.jsxs)("div",{children:["Author: ",Object(d.jsx)("input",{value:l,onChange:function(e){e.preventDefault(),j(e.target.value)}})]}),Object(d.jsxs)("div",{children:["Url: ",Object(d.jsx)("input",{value:f,onChange:function(e){e.preventDefault(),h(e.target.value)}})]}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{type:"submit",children:"Add"})})]})]})},C=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),s=Object(i.a)(c,2),l=s[0],b=s[1],p=Object(r.useState)(null),f=Object(i.a)(p,2),h=f[0],v=f[1],O=Object(r.useState)(""),g=Object(i.a)(O,2),C=g[0],B=g[1],L=Object(r.useState)(""),A=Object(i.a)(L,2),D=A[0],T=A[1],E=Object(r.useState)(null),N=Object(i.a)(E,2),U=N[0],J=N[1];Object(r.useEffect)((function(){console.log("useEffect py\xf6r\xe4ht\xe4\xe4"),x.getAll().then((function(e){return a(e.sort((function(e,t){return e.likes-t.likes})))}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);J(t),x.setToken(t.token)}}),[]);var z=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,m.login({username:C,password:D});case 4:n=e.sent,window.localStorage.setItem("loggedUser",JSON.stringify(n)),x.setToken(n.token),J(n),B(""),T(""),v("update"),b("Logged in as ".concat(n.name)),setTimeout((function(){v(null),b(null)}),3e3),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(1),v("delete"),b("wrong username or password"),setTimeout((function(){v(null),b(null)}),3e3);case 20:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("logging out with the username",C),localStorage.clear(),window.location.reload();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(e){var t=e.message,n=e.type;v(n),b("".concat(t)),setTimeout((function(){v(null),b(null)}),3e3)},W=function(){var e=Object(u.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.create(t);case 3:r=e.sent,console.log("returned and created blog from backend:",r),a(n.concat(r).sort((function(e,t){return e.likes-t.likes}))),P({message:"".concat(t.title," was added to the Blogister-list"),type:"update"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),P({message:"Cannot add ".concat(t.title),type:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(u.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("blogs",n),console.log("1",t),e.prev=2,e.next=5,x.put(t.id,t);case 5:r=e.sent,a(n.map((function(e){return e.id!==t.id?e:r})).sort((function(e,t){return e.likes-t.likes}))),P({message:"You liked ".concat(t.title,"!"),type:"update"}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),P({message:"Could not update the ".concat(t.title," blog."),type:"delete"});case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{window.confirm("Delete ".concat(t.title," ?"))&&(x.remove(t.id),a(n.filter((function(e){return e.id!==t.id})).sort((function(e,t){return e.likes-t.likes}))),P({message:"".concat(t.title," was removed from the Blogister-list"),type:"delete"}))}catch(r){P({message:"Error has occurred. Could not delete ".concat(t.title,"."),type:"delete"})}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{children:[Object(d.jsx)("p",{children:"Blog version 0.2 (work in progress)"}),Object(d.jsx)(w,{message:l,className:h}),null===U?Object(d.jsx)(k,{buttonLabel:"Log in",children:Object(d.jsx)(y,{username:C,password:D,onUsernameChange:function(e){var t=e.target;return B(t.value)},onPasswordChange:function(e){var t=e.target;return T(t.value)},handleSubmit:z})}):Object(d.jsxs)("div",{children:[Object(d.jsxs)("p",{children:["Logged in as: ",U.name," ",Object(d.jsx)("button",{onClick:I,children:"logout"})]}),Object(d.jsx)("div",{children:Object(d.jsx)(k,{buttonLabel:"Add a new blog",children:Object(d.jsx)(S,{createBlog:W})})}),Object(d.jsx)("h2",{children:"blogs"}),Object(d.jsx)("ul",{children:n.map((function(e){return Object(d.jsx)(j,{blog:e,updateBlog:Y,removeBlog:q},e.id)}))})]})]})};n(42);c.a.render(Object(d.jsx)(C,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.d8c9abd8.chunk.js.map